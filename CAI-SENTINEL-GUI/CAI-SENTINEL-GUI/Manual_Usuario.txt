
                    MANUAL DE USUARIO - CAI-SENTINEL
                    Sistema de Detecci√≥n de Intrusos


1. OBJETIVO


CAI-Sentinel es un sistema avanzado de detecci√≥n de intrusos (IDS) dise√±ado para 
proteger informaci√≥n sensible mediante la implementaci√≥n de archivos se√±uelo 
(honeypots). Su objetivo principal es:

‚Ä¢ Detectar accesos no autorizados a informaci√≥n sensible
‚Ä¢ Crear alertas autom√°ticas cuando se detecta actividad sospechosa
‚Ä¢ Implementar medidas de seguridad proporcionales al nivel de amenaza
‚Ä¢ Mantener un registro detallado de todos los eventos de seguridad
‚Ä¢ Aislar y proteger el sistema cuando se detecta una intrusi√≥n

El sistema funciona como una "trampa" que atrae a atacantes hacia archivos 
aparentemente valiosos, pero que en realidad est√°n dise√±ados para detectar y 
responder a accesos no autorizados.

2. FUNCIONAMIENTO


El sistema CAI-Sentinel opera mediante los siguientes mecanismos:

A) CREACI√ìN DE ARCHIVOS SE√ëUELO
   - Genera archivos con contenido enga√±oso que simulan informaci√≥n sensible
   - Los archivos contienen credenciales falsas, hashes de verificaci√≥n y 
     advertencias de seguridad
   - Se ubican en carpetas estrat√©gicas para atraer la atenci√≥n de atacantes

B) MONITOREO EN TIEMPO REAL
   - Utiliza FileSystemWatcher para detectar cambios en archivos se√±uelo
   - Monitorea eventos de creaci√≥n, modificaci√≥n, eliminaci√≥n y renombrado
   - Verifica la integridad de archivos mediante hashes criptogr√°ficos
   - Supervisa eventos de auditor√≠a de Windows (ID 4663)

C) DETECCI√ìN DE AMENAZAS
   - Compara hashes actuales con valores de referencia
   - Identifica patrones de acceso sospechoso
   - Detecta intentos de manipulaci√≥n de archivos
   - Monitorea apertura y cierre de archivos se√±uelo

D) RESPUESTA AUTOM√ÅTICA
   - Implementa medidas de seguridad escalonadas
   - Env√≠a alertas por email en tiempo real
   - Bloquea la estaci√≥n de trabajo cuando es necesario
   - Deshabilita adaptadores de red para aislar el sistema
   - Fuerza el cierre de sesi√≥n en casos cr√≠ticos

3. TABLA DE ACCIONES


| EVENTO DETECTADO          | ACCI√ìN INMEDIATA           | ACCI√ìN SECUNDARIA          |
|---------------------------|----------------------------|---------------------------|
| Modificaci√≥n de archivo   | ‚Ä¢ Calcular nuevo hash      | ‚Ä¢ Enviar alerta por email |
|                           | ‚Ä¢ Comparar con original    | ‚Ä¢ Bloquear estaci√≥n       |
|                           | ‚Ä¢ Registrar violaci√≥n      | ‚Ä¢ Deshabilitar red        |
|---------------------------|----------------------------|---------------------------|
| Eliminaci√≥n de archivo    | ‚Ä¢ Activar protocolo rojo   | ‚Ä¢ Cerrar sesi√≥n (3s)      |
|                           | ‚Ä¢ Bloquear inmediatamente  | ‚Ä¢ Apagar equipo (10s)     |
|                           | ‚Ä¢ Enviar alerta cr√≠tica    | ‚Ä¢ Recrear archivo         |
|---------------------------|----------------------------|---------------------------|
| Renombrado de archivo     | ‚Ä¢ Registrar intento        | ‚Ä¢ Bloquear estaci√≥n       |
|                           | ‚Ä¢ Enviar alerta            | ‚Ä¢ Deshabilitar red        |
|---------------------------|----------------------------|---------------------------|
| Apertura de archivo       | ‚Ä¢ Detectar acceso          | ‚Ä¢ Deshabilitar red        |
|                           | ‚Ä¢ Esperar cierre           | ‚Ä¢ Cerrar sesi√≥n           |
|---------------------------|----------------------------|---------------------------|
| Acceso por auditor√≠a      | ‚Ä¢ Verificar usuario        | ‚Ä¢ Bloquear estaci√≥n       |
| (ID 4663)                | ‚Ä¢ Filtrar falsos positivos | ‚Ä¢ Deshabilitar red        |
|---------------------------|----------------------------|---------------------------|
| Verificaci√≥n peri√≥dica    | ‚Ä¢ Comparar hashes          | ‚Ä¢ Registrar anomal√≠a      |
| (cada 30 min)            | ‚Ä¢ Validar integridad       | ‚Ä¢ Enviar alerta si es    |
|                           |                            |   necesario               |

4. INSTALACI√ìN Y CONFIGURACI√ìN


PASO 1: PREPARACI√ìN DEL SISTEMA
   ‚Ä¢ Asegurar que el equipo tenga Windows 10/11
   ‚Ä¢ Verificar permisos de administrador (recomendado)
   ‚Ä¢ Tener conexi√≥n a internet para alertas por email

PASO 2: EJECUCI√ìN DE LA APLICACI√ìN
   ‚Ä¢ Ejecutar CAI-SENTINEL-GUI.exe
   ‚Ä¢ La aplicaci√≥n se minimizar√° autom√°ticamente a la bandeja del sistema
   ‚Ä¢ Hacer doble clic en el √≠cono de la bandeja para mostrar la ventana principal

PASO 3: INICIO DEL SISTEMA
   ‚Ä¢ Hacer clic en "‚ñ∂ Iniciar Sistema"
   ‚Ä¢ El sistema crear√° autom√°ticamente la estructura de carpetas
   ‚Ä¢ Se generar√°n los archivos se√±uelo iniciales
   ‚Ä¢ El monitoreo comenzar√° inmediatamente

PASO 4: VERIFICACI√ìN DE FUNCIONAMIENTO
   ‚Ä¢ El estado cambiar√° a "üü¢ Estado: Activo"
   ‚Ä¢ La barra de salud mostrar√° 100%
   ‚Ä¢ Los logs comenzar√°n a mostrar actividad
   ‚Ä¢ Se enviar√° una alerta de inicio por email

CONFIGURACI√ìN AVANZADA:
   ‚Ä¢ Modo Administrador: Ejecutar como administrador para m√°xima protecci√≥n
   ‚Ä¢ Modo Usuario: Funciona con permisos limitados pero efectivo
   ‚Ä¢ Configuraci√≥n SMTP: Editar credenciales en el c√≥digo fuente si es necesario

5. ESTRUCTURA DE ARCHIVOS


C:\CAI\ (Modo Administrador)
‚îî‚îÄ‚îÄ Claves de acceso\
    ‚îî‚îÄ‚îÄ Claves.CAI.txt (Archivo se√±uelo principal)
‚îî‚îÄ‚îÄ Security\
    ‚îú‚îÄ‚îÄ SentinelLog.txt (Log principal del sistema)
    ‚îî‚îÄ‚îÄ IntegrityAudit.log (Log de auditor√≠a de integridad)
‚îî‚îÄ‚îÄ Administraci√≥n\
‚îî‚îÄ‚îÄ Proyectos\
    ‚îú‚îÄ‚îÄ P√∫blicos\
    ‚îî‚îÄ‚îÄ Privados\
‚îî‚îÄ‚îÄ Base de Datos\
‚îî‚îÄ‚îÄ Respaldos\
‚îî‚îÄ‚îÄ Documentaci√≥n T√©cnica\
    ‚îú‚îÄ‚îÄ Manuales\
    ‚îî‚îÄ‚îÄ Arquitecturas\

%APPDATA%\CAI\ (Modo Usuario)
‚îî‚îÄ‚îÄ [Misma estructura que arriba]

ARCHIVOS PRINCIPALES:
‚Ä¢ Claves.CAI.txt: Archivo se√±uelo con credenciales falsas
‚Ä¢ SentinelLog.txt: Registro de todos los eventos del sistema
‚Ä¢ IntegrityAudit.log: Log espec√≠fico de violaciones de integridad

6. USUARIOS Y PERMISOS


ROLES DEFINIDOS EN EL SISTEMA:

A) CAI_Adm (Coordinadores del CAI)
   ‚Ä¢ Permisos: Modify
   ‚Ä¢ Acceso: Carpeta Administraci√≥n
   ‚Ä¢ Responsabilidades: Gesti√≥n general del sistema

B) CAI_Pub (Acceso p√∫blico)
   ‚Ä¢ Permisos: ReadAndExecute
   ‚Ä¢ Acceso: Proyectos/P√∫blicos
   ‚Ä¢ Responsabilidades: Consulta de informaci√≥n p√∫blica

C) CAI_Priv (Proyectos internos)
   ‚Ä¢ Permisos: Modify
   ‚Ä¢ Acceso: Proyectos/Privados
   ‚Ä¢ Responsabilidades: Gesti√≥n de proyectos internos

D) CAI_DB (Responsables t√©cnicos)
   ‚Ä¢ Permisos: Modify
   ‚Ä¢ Acceso: Base de Datos
   ‚Ä¢ Responsabilidades: Administraci√≥n de bases de datos

E) CAI_Backup (Personal autorizado)
   ‚Ä¢ Permisos: Modify
   ‚Ä¢ Acceso: Respaldos
   ‚Ä¢ Responsabilidades: Gesti√≥n de respaldos

F) CAI_Docs (Documentaci√≥n t√©cnica)
   ‚Ä¢ Permisos: ReadAndExecute
   ‚Ä¢ Acceso: Documentaci√≥n T√©cnica
   ‚Ä¢ Responsabilidades: Consulta de documentaci√≥n

PERMISOS ESPECIALES:
‚Ä¢ Sistema: Control total sobre todas las carpetas
‚Ä¢ Administradores: Control total sobre todas las carpetas
‚Ä¢ Usuario actual: Control total sobre todas las carpetas
‚Ä¢ Usuarios autenticados: Lectura/escritura limitada

7. CONSIDERACIONES DE SEGURIDAD


ADVERTENCIAS IMPORTANTES:

A) ARCHIVOS SE√ëUELO
   ‚Ä¢ Los archivos contienen informaci√≥n falsa dise√±ada para atraer atacantes
   ‚Ä¢ NO contienen informaci√≥n real o sensible
   ‚Ä¢ Est√°n dise√±ados para ser detectados y manipulados
   ‚Ä¢ Su eliminaci√≥n o modificaci√≥n activar√° las medidas de seguridad

B) MEDIDAS DE SEGURIDAD
   ‚Ä¢ El sistema puede bloquear la estaci√≥n de trabajo
   ‚Ä¢ Puede deshabilitar adaptadores de red
   ‚Ä¢ Puede forzar el cierre de sesi√≥n
   ‚Ä¢ Puede apagar el equipo en casos cr√≠ticos
   ‚Ä¢ Todas las acciones son autom√°ticas y no requieren confirmaci√≥n

C) ALERTAS POR EMAIL
   ‚Ä¢ Se env√≠an alertas autom√°ticas a las direcciones configuradas
   ‚Ä¢ Las credenciales SMTP est√°n hardcodeadas en el c√≥digo
   ‚Ä¢ Se recomienda cambiar las credenciales antes del uso en producci√≥n

D) LOGS Y AUDITOR√çA
   ‚Ä¢ Todos los eventos se registran en archivos de log
   ‚Ä¢ Los logs pueden crecer significativamente con el tiempo
   ‚Ä¢ Se implementa rotaci√≥n autom√°tica de logs
   ‚Ä¢ Los logs contienen informaci√≥n sensible de seguridad

8. SOLUCI√ìN DE PROBLEMAS


PROBLEMA: "Error al iniciar el sistema"
SOLUCI√ìN:
   ‚Ä¢ Verificar permisos de administrador
   ‚Ä¢ Asegurar que no hay otros procesos usando los archivos
   ‚Ä¢ Verificar que las carpetas de destino no est√©n protegidas
   ‚Ä¢ Revisar los logs de Windows para errores espec√≠ficos

PROBLEMA: "No se env√≠an alertas por email"
SOLUCI√ìN:
   ‚Ä¢ Verificar conexi√≥n a internet
   ‚Ä¢ Comprobar configuraci√≥n SMTP en el c√≥digo
   ‚Ä¢ Verificar credenciales de email
   ‚Ä¢ Revisar firewall y antivirus

PROBLEMA: "Falsos positivos frecuentes"
SOLUCI√ìN:
   ‚Ä¢ Ajustar filtros de usuario en el c√≥digo
   ‚Ä¢ Revisar exclusiones de procesos
   ‚Ä¢ Verificar configuraci√≥n de auditor√≠a de Windows
   ‚Ä¢ Ajustar intervalos de verificaci√≥n

PROBLEMA: "El sistema no detecta intrusiones"
SOLUCI√ìN:
   ‚Ä¢ Verificar que FileSystemWatcher est√© activo
   ‚Ä¢ Comprobar permisos en carpetas de monitoreo
   ‚Ä¢ Revisar logs del sistema
   ‚Ä¢ Verificar que los archivos se√±uelo existan

PROBLEMA: "Alto uso de CPU"
SOLUCI√ìN:
   ‚Ä¢ Ajustar intervalos de verificaci√≥n peri√≥dica
   ‚Ä¢ Reducir frecuencia de monitoreo de eventos
   ‚Ä¢ Optimizar procesos de limpieza de logs
   ‚Ä¢ Revisar configuraciones de threads

9. MANTENIMIENTO


TAREAS DIARIAS:
   ‚Ä¢ Verificar que el sistema est√© activo
   ‚Ä¢ Revisar logs de eventos recientes
   ‚Ä¢ Comprobar que las alertas se env√≠an correctamente

TAREAS SEMANALES:
   ‚Ä¢ Revisar archivos de log para patrones sospechosos
   ‚Ä¢ Verificar integridad de archivos se√±uelo
   ‚Ä¢ Comprobar permisos de carpetas
   ‚Ä¢ Actualizar credenciales si es necesario

TAREAS MENSUALES:
   ‚Ä¢ Rotar archivos de log antiguos
   ‚Ä¢ Verificar configuraci√≥n de auditor√≠a de Windows
   ‚Ä¢ Revisar y actualizar exclusiones de procesos
   ‚Ä¢ Comprobar conectividad de red

TAREAS TRIMESTRALES:
   ‚Ä¢ Revisar y actualizar archivos se√±uelo
   ‚Ä¢ Verificar configuraci√≥n SMTP
   ‚Ä¢ Actualizar permisos de usuarios si es necesario
   ‚Ä¢ Revisar pol√≠ticas de seguridad

LIMPIEZA AUTOM√ÅTICA:
   ‚Ä¢ Los logs se rotan autom√°ticamente cuando superan 10MB
   ‚Ä¢ Los logs de integridad se rotan cuando superan 5MB
   ‚Ä¢ El sistema mantiene un m√°ximo de archivos de log

10. CONCLUSIONES


VENTAJAS DEL SISTEMA CAI-SENTINEL:

A) DETECCI√ìN PROACTIVA
   ‚Ä¢ Identifica intrusiones antes de que causen da√±o
   ‚Ä¢ Utiliza t√©cnicas de honeypot para atraer atacantes
   ‚Ä¢ Proporciona alertas en tiempo real

B) RESPUESTA AUTOM√ÅTICA
   ‚Ä¢ Implementa medidas de seguridad inmediatas
   ‚Ä¢ Reduce el tiempo de respuesta a incidentes
   ‚Ä¢ Minimiza el impacto de intrusiones

C) REGISTRO COMPLETO
   ‚Ä¢ Mantiene logs detallados de todos los eventos
   ‚Ä¢ Facilita la investigaci√≥n forense
   ‚Ä¢ Proporciona evidencia para an√°lisis posterior

D) FLEXIBILIDAD
   ‚Ä¢ Funciona en modo administrador o usuario
   ‚Ä¢ Configurable seg√∫n necesidades espec√≠ficas
   ‚Ä¢ Escalable para diferentes entornos

E) INTEGRACI√ìN
   ‚Ä¢ Se integra con sistemas de auditor√≠a de Windows
   ‚Ä¢ Compatible con infraestructura existente
   ‚Ä¢ No interfiere con operaciones normales

BENEFICIOS ESPERADOS:

‚Ä¢ Reducci√≥n del tiempo de detecci√≥n de intrusiones
‚Ä¢ Mejora en la capacidad de respuesta a incidentes
‚Ä¢ Incremento en la visibilidad de amenazas
‚Ä¢ Fortalecimiento de la postura de seguridad general
‚Ä¢ Cumplimiento de requisitos de auditor√≠a y compliance

El sistema CAI-Sentinel representa una capa adicional de seguridad que 
complementa las medidas tradicionales de protecci√≥n, proporcionando 
detecci√≥n temprana y respuesta autom√°tica a amenazas potenciales.


                    FIN DEL MANUAL DE USUARIO


Fecha de creaci√≥n: [Fecha actual]
Versi√≥n del sistema: 1.0
Desarrollado para: CAI (Centro de An√°lisis de Informaci√≥n) 